syntax = "proto3";

package clientpb;
option go_package = "github.com/chainreactors/malice-network/proto/client/clientpb";

import "implant/commonpb/common.proto";


message Empty {}

message Basic {
  int32 major = 1;
  int32 minor = 2;
  int32 patch = 3;

  string commit = 4;
  bool dirty = 5;
  int64 compiledAt = 6;

  string os = 7;
  string arch = 8;
}

message Session {
  string session_id = 1;
  string name = 2;
  string remote_addr = 3;
  bool is_dead = 4;
  string version = 5;
  string listener_id = 6;
  commonpb.Os os = 11;
  commonpb.Process process = 12;
  commonpb.Timer timer = 13;
}

message Sessions {
  repeated Session sessions = 1;
}

message Job {
  uint32 id = 1;
  string name = 2;
  string description = 3;
  string protocol = 4;
  uint32 port = 5;

  repeated string domains = 6;
}

message Jobs {
  repeated Job active = 1;
}

message Client {
  uint32 ID = 1;
  string Name = 2;
  bool Online = 3;
}

message Clients {
  repeated Client Clients = 1;
}

message Event {
  string EventType = 1;
  Session Session = 2;
  Job Job = 3;
  Client Client = 4;
  bytes Data = 5;

  string Err = 6; // Can't trigger normal gRPC error
}

message KillJobReq {
  uint32 id = 1;
}

message KillJob {
  uint32 id = 1;
  bool Success = 2;
}

message RegisterReq {
  string host = 1;
  string user = 2;
}

message RegisterResp {
  bytes certs = 1;
  bytes private_key = 2;
}
