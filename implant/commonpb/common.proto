syntax = "proto3";

package commonpb;
option go_package = "github.com/chainreactors/malice-network/proto/implant/commonpb";

import "implant/pluginpb/plugin.proto";


message Spite {
  uint32 task_id = 1;
  uint32 session_id = 2;
  oneof body {
    liteSpite lite_spite = 3;
    pluginpb.ExecRequest exec_request = 4;
    pluginpb.ExecResponse exec_response = 5;
    pluginpb.UploadRequest upload_request = 6;
    pluginpb.UploadResponse upload_response = 7;
    pluginpb.DownloadRequest download_request = 8;
    pluginpb.DownloadResponse download_response = 9;
  }
}


message liteSpite {
  uint32 task_id = 1;
  uint32 type = 2;
  bytes content = 3;
}

message RegisterRequest {
  string beaconId = 1;
  Os os = 2;
  Process process = 3;
  Timer timer = 4;
}

message RegisterResponse {
  bool status = 1;
  string padding = 2;
}

message Os {
  string name = 1;
  string version = 2;
  string arch = 3;
  string username = 4;
  string hostname = 5;
  string locale = 6;
}

message Process {
  string uid = 1;
  string pid = 2;
  string gid = 3;
  string name = 4;
  string args = 5;
}

message Timer {
  int64 interval = 1;
  int64 jitter = 2;
  int64 heartbeat = 3;
}


